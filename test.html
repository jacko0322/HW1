<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NBA API çƒå“¡æ•¸æ“šå¯ç”¨æ€§æª¢æŸ¥å™¨</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .controls {
            text-align: center;
            margin-bottom: 30px;
        }
        
        button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
            margin: 0 10px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .progress {
            background: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
            height: 30px;
            position: relative;
        }
        
        .progress-bar {
            background: linear-gradient(45deg, #667eea, #764ba2);
            height: 100%;
            width: 0%;
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .results {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .result-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #e9ecef;
        }
        
        .success {
            border-color: #28a745;
        }
        
        .error {
            border-color: #dc3545;
        }
        
        .result-header {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }
        
        .success .result-header {
            background: #d4edda;
            color: #155724;
        }
        
        .error .result-header {
            background: #f8d7da;
            color: #721c24;
        }
        
        .player-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: white;
        }
        
        .player-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .player-item:last-child {
            border-bottom: none;
        }
        
        .player-rank {
            background: #007bff;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .summary {
            background: #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .stat-box {
            display: inline-block;
            margin: 0 15px;
            padding: 10px 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #666;
            text-transform: uppercase;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            font-style: italic;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ€ NBA API çƒå“¡æ•¸æ“šå¯ç”¨æ€§æª¢æŸ¥å™¨</h1>
        
        <div class="controls">
            <button onclick="checkAllPlayers()" id="checkBtn">é–‹å§‹æª¢æŸ¥æ‰€æœ‰100åçƒå“¡</button>
            <button onclick="checkTop20()" id="checkTop20Btn">åƒ…æª¢æŸ¥å‰20å</button>
            <button onclick="resetResults()" id="resetBtn">é‡ç½®çµæœ</button>
        </div>
        
        <div class="progress" id="progressContainer" style="display: none;">
            <div class="progress-bar" id="progressBar">0%</div>
        </div>
        
        <div class="summary" id="summary" style="display: none;">
            <div class="stat-box">
                <div class="stat-number" id="totalChecked">0</div>
                <div class="stat-label">å·²æª¢æŸ¥</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="successCount">0</div>
                <div class="stat-label">æˆåŠŸæ‰¾åˆ°</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="errorCount">0</div>
                <div class="stat-label">æ‰¾ä¸åˆ°</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="successRate">0%</div>
                <div class="stat-label">æˆåŠŸç‡</div>
            </div>
        </div>
        
        <div class="results" id="results" style="display: none;">
            <div class="result-section success">
                <div class="result-header">âœ… APIä¸­æ‰¾åˆ°çš„çƒå“¡</div>
                <div class="player-list" id="successList"></div>
            </div>
            
            <div class="result-section error">
                <div class="result-header">âŒ APIä¸­æ‰¾ä¸åˆ°çš„çƒå“¡</div>
                <div class="player-list" id="errorList"></div>
            </div>
        </div>
        
        <div class="loading" id="loadingMsg" style="display: none;">
            æ­£åœ¨æª¢æŸ¥çƒå“¡æ•¸æ“šå¯ç”¨æ€§...
        </div>
    </div>

    <script>
        const top100Players = [
            "Nikola Jokic", "Luka Doncic", "Shai Gilgeous-Alexander", "Giannis Antetokounmpo", "Joel Embiid",
            "Jayson Tatum", "Anthony Edwards", "Jalen Brunson", "Anthony Davis", "Victor Wembanyama",
            "Kevin Durant", "Tyrese Haliburton", "LeBron James", "Stephen Curry", "Tyrese Maxey",
            "Devin Booker", "Donovan Mitchell", "Jaylen Brown", "Ja Morant", "Domantas Sabonis",
            "Damian Lillard", "Zion Williamson", "Paolo Banchero", "De'Aaron Fox", "Pascal Siakam",
            "Kawhi Leonard", "Paul George", "Bam Adebayo", "Trae Young", "Jimmy Butler",
            "Karl-Anthony Towns", "Rudy Gobert", "Kyrie Irving", "Lauri Markkanen", "Scottie Barnes",
            "Jamal Murray", "Cade Cunningham", "Julius Randle", "Alperen Sengun", "Chet Holmgren",
            "LaMelo Ball", "Jaren Jackson Jr", "Jalen Williams", "Kristaps Porzingis", "DeMar DeRozan",
            "Brandon Ingram", "James Harden", "Franz Wagner", "Desmond Bane", "Derrick White",
            "Evan Mobley", "Darius Garland", "Myles Turner", "Jrue Holiday", "Dejounte Murray",
            "Mikal Bridges", "OG Anunoby", "Brandon Miller", "Aaron Gordon", "Jarrett Allen",
            "Kyle Kuzma", "Zach LaVine", "Austin Reaves", "Michael Porter Jr", "Jalen Green",
            "Fred VanVleet", "Miles Bridges", "Jalen Johnson", "Tyler Herro", "Coby White",
            "CJ McCollum", "Josh Giddey", "Bradley Beal", "Trey Murphy", "D'Angelo Russell",
            "Devin Vassell", "Immanuel Quickley", "Herb Jones", "Jaden McDaniels", "Jerami Grant",
            "Josh Hart", "Keegan Murray", "Jonathan Kuminga", "Malik Monk", "Cam Thomas",
            "Donte DiVincenzo", "Anfernee Simons", "Jabari Smith Jr", "Nikola Vucevic", "Tobias Harris",
            "Naz Reid", "Luguentz Dort", "Jalen Suggs", "PJ Washington", "RJ Barrett",
            "Khris Middleton", "Deandre Ayton", "Collin Sexton", "Dereck Lively", "Klay Thompson"
        ];

        let successPlayers = [];
        let errorPlayers = [];
        let currentIndex = 0;
        let isChecking = false;

        async function checkAllPlayers() {
            await checkPlayers(top100Players);
        }

        async function checkTop20() {
            await checkPlayers(top100Players.slice(0, 20));
        }

        async function checkPlayers(playerList) {
            if (isChecking) return;
            
            isChecking = true;
            resetResults();
            
            const checkBtn = document.getElementById('checkBtn');
            const checkTop20Btn = document.getElementById('checkTop20Btn');
            const progressContainer = document.getElementById('progressContainer');
            const progressBar = document.getElementById('progressBar');
            const loadingMsg = document.getElementById('loadingMsg');
            
            checkBtn.disabled = true;
            checkTop20Btn.disabled = true;
            progressContainer.style.display = 'block';
            loadingMsg.style.display = 'block';
            
            successPlayers = [];
            errorPlayers = [];
            currentIndex = 0;
            
            for (let i = 0; i < playerList.length; i++) {
                const playerName = playerList[i];
                currentIndex = i + 1;
                
                // æ›´æ–°é€²åº¦
                const progress = ((i + 1) / playerList.length) * 100;
                progressBar.style.width = progress + '%';
                progressBar.textContent = `${Math.round(progress)}% (${i + 1}/${playerList.length})`;
                
                loadingMsg.textContent = `æ­£åœ¨æª¢æŸ¥: ${playerName} (${i + 1}/${playerList.length})`;
                
                try {
                    const success = await checkPlayerInAPI(playerName, i + 1);
                    if (success) {
                        successPlayers.push({name: playerName, rank: i + 1, data: success});
                    } else {
                        errorPlayers.push({name: playerName, rank: i + 1});
                    }
                } catch (error) {
                    console.error(`æª¢æŸ¥ ${playerName} æ™‚å‡ºéŒ¯:`, error);
                    errorPlayers.push({name: playerName, rank: i + 1, error: error.message});
                }
                
                // æ›´æ–°å¯¦æ™‚çµ±è¨ˆ
                updateSummary();
                
                // å°å»¶é²é¿å…APIè«‹æ±‚éæ–¼é »ç¹
                await new Promise(resolve => setTimeout(resolve, 200));
            }
            
            // é¡¯ç¤ºæœ€çµ‚çµæœ
            displayResults();
            
            checkBtn.disabled = false;
            checkTop20Btn.disabled = false;
            loadingMsg.style.display = 'none';
            isChecking = false;
        }

        async function checkPlayerInAPI(playerName, rank) {
            try {
                // å˜—è©¦å¤šç¨®APIç«¯é»
                const endpoints = ['PlayerDataAdvanced', 'PlayerDataTotals'];
                
                for (const endpoint of endpoints) {
                    const encodedName = encodeURIComponent(playerName);
                    const response = await fetch(`http://rest.nbaapi.com/api/${endpoint}/name/${encodedName}`);
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (Array.isArray(data) && data.length > 0) {
                            return {
                                endpoint: endpoint,
                                dataCount: data.length,
                                latestSeason: Math.max(...data.map(d => d.season || 0)),
                                team: data[0].team || 'N/A'
                            };
                        }
                    }
                }
                
                return false;
            } catch (error) {
                console.error(`APIè«‹æ±‚å¤±æ•— ${playerName}:`, error);
                return false;
            }
        }

        function updateSummary() {
            const summary = document.getElementById('summary');
            summary.style.display = 'block';
            
            document.getElementById('totalChecked').textContent = currentIndex;
            document.getElementById('successCount').textContent = successPlayers.length;
            document.getElementById('errorCount').textContent = errorPlayers.length;
            
            const successRate = currentIndex > 0 ? ((successPlayers.length / currentIndex) * 100).toFixed(1) : 0;
            document.getElementById('successRate').textContent = successRate + '%';
        }

        function displayResults() {
            const results = document.getElementById('results');
            const successList = document.getElementById('successList');
            const errorList = document.getElementById('errorList');
            
            results.style.display = 'grid';
            
            // é¡¯ç¤ºæˆåŠŸçš„çƒå“¡
            successList.innerHTML = successPlayers.map(player => `
                <div class="player-item">
                    <div>
                        <div class="player-rank">${player.rank}</div>
                    </div>
                    <div style="flex: 1; margin-left: 15px;">
                        <strong>${player.name}</strong><br>
                        <small>çƒéšŠ: ${player.data.team} | æ•¸æ“šç­†æ•¸: ${player.data.dataCount} | æœ€æ–°è³½å­£: ${player.data.latestSeason}</small>
                    </div>
                </div>
            `).join('');
            
            // é¡¯ç¤ºå¤±æ•—çš„çƒå“¡
            errorList.innerHTML = errorPlayers.map(player => `
                <div class="player-item">
                    <div>
                        <div class="player-rank" style="background: #dc3545;">${player.rank}</div>
                    </div>
                    <div style="flex: 1; margin-left: 15px;">
                        <strong>${player.name}</strong><br>
                        <small style="color: #dc3545;">APIä¸­æ‰¾ä¸åˆ°æ•¸æ“š</small>
                    </div>
                </div>
            `).join('');
        }

        function resetResults() {
            document.getElementById('progressContainer').style.display = 'none';
            document.getElementById('summary').style.display = 'none';
            document.getElementById('results').style.display = 'none';
            document.getElementById('loadingMsg').style.display = 'none';
            
            successPlayers = [];
            errorPlayers = [];
            currentIndex = 0;
        }
    </script>
</body>
</html>